knitr::opts_chunk$set(echo = TRUE)
library(KMsurv)
library(survival)
library(survminer)
data(burn)
# Log-log plot for Z1 (Treatment Type)
burn.fit1 <- survfit(burn.surv ~ Z1, data = burn)
knitr::opts_chunk$set(echo = TRUE)
library(KMsurv)
library(survival)
library(survminer)
data(burn)
burn.surv <- Surv(time = burn$T3, event = burn$D3)
ggsurvplot(
survfit(burn.surv ~ 1),
surv.median.line = "hv",
data = burn,
xlab = "Time (Days)",
ylab = "Survival Probability",
title = "KM Estimate of Time to Staphylococcus Aureus Infection"
)
cox_full <- coxph(burn.surv ~ Z1 + Z2 + Z3 + Z4 + Z5 + Z6 + Z7 + Z8 + Z9 + Z10 + as.factor(Z11), data = burn)
summary(cox_full)
cox_step <- step(coxph(burn.surv ~ 1, data = burn), scope = ~ Z1 + Z2 + Z3 + Z4 + Z5 + Z6 + Z7 + Z8 + Z9 + Z10 + as.factor(Z11), direction = "forward", k = 2)
summary(cox_step)
# Log-log plot for Z1 (Treatment Type)
burn.fit1 <- survfit(burn.surv ~ Z1, data = burn)
ggsurvplot(burn.fit1,
legend.labs = c("Routine Bathing", "Body Cleansing"),
fun = "cloglog") +
labs(title = "Log(-log) of Survival Function by Treatment (Z1)",
x = "Time (Days) to straphylocous aureaus infection")
# Log-log plot for Z2 (gender)
burn.fit2 <- survfit(burn.surv ~ Z2, data = burn)
ggsurvplot(burn.fit1,
#legend.labs = c("Routine Bathing", "Body Cleansing"),
fun = "cloglog") +
labs(title = "Log(-log) of Survival Function by Gender (Z2)",
x = "Time (Days) to straphylocous aureaus infection")
# Log-log plot for Z3 (race)
burn.fit2 <- survfit(burn.surv ~ Z2, data = burn)
ggsurvplot(burn.fit1,
#legend.labs = c("Routine Bathing", "Body Cleansing"),
fun = "cloglog") +
labs(title = "Log(-log) of Survival Function by Race (Z3)",
x = "Time (Days) to straphylocous aureaus infection")
# Log-log plot for Z11 (burn type)
burn.fit2 <- survfit(burn.surv ~ as.factor(Z11), data = burn)
ggsurvplot(burn.fit1,
#legend.labs = c("Routine Bathing", "Body Cleansing"),
fun = "cloglog") +
labs(title = "Log(-log) of Survival Function for Burn Type (Z11)",
x = "Time (Days) to straphylocous aureaus infection")
# Cox ZPH test for correlation in the residuals
zph_test <- cox.zph(cox_step)
print(zph_test)
plot(zph_test)
# Log-log plot for Z1 (Treatment Type)
burn.fit1 <- survfit(burn.surv ~ Z1, data = burn)
ggsurvplot(burn.fit1,
legend.labs = c("Routine Bathing", "Body Cleansing"),
fun = "cloglog") +
labs(title = "Log(-log) of Survival Function by Treatment (Z1)",
x = "Time (Days) to straphylocous aureaus infection")
# Log-log plot for Z2 (gender)
burn.fit2 <- survfit(burn.surv ~ Z2, data = burn)
ggsurvplot(burn.fit1,
#legend.labs = c("Routine Bathing", "Body Cleansing"),
fun = "cloglog") +
labs(title = "Log(-log) of Survival Function by Gender (Z2)",
x = "Time (Days) to straphylocous aureaus infection")
# Log-log plot for Z3 (race)
burn.fit3 <- survfit(burn.surv ~ Z2, data = burn)
ggsurvplot(burn.fit1,
#legend.labs = c("Routine Bathing", "Body Cleansing"),
fun = "cloglog") +
labs(title = "Log(-log) of Survival Function by Race (Z3)",
x = "Time (Days) to straphylocous aureaus infection")
# Log-log plot for Z11 (burn type)
burn.fit4 <- survfit(burn.surv ~ as.factor(Z11), data = burn)
ggsurvplot(burn.fit1,
#legend.labs = c("Routine Bathing", "Body Cleansing"),
fun = "cloglog") +
labs(title = "Log(-log) of Survival Function for Burn Type (Z11)",
x = "Time (Days) to straphylocous aureaus infection")
# Cox ZPH test for correlation in the residuals
zph_test <- cox.zph(cox_step)
print(zph_test)
plot(zph_test)
# Log-log plot for Z1 (Treatment Type)
burn.fit1 <- survfit(burn.surv ~ Z1, data = burn)
ggsurvplot(burn.fit1,
legend.labs = c("Routine Bathing", "Body Cleansing"),
fun = "cloglog") +
labs(title = "Log(-log) of Survival Function by Treatment (Z1)",
x = "Time (Days) to straphylocous aureaus infection")
# Log-log plot for Z2 (gender)
burn.fit2 <- survfit(burn.surv ~ Z2, data = burn)
ggsurvplot(burn.fit2,
#legend.labs = c("Routine Bathing", "Body Cleansing"),
fun = "cloglog") +
labs(title = "Log(-log) of Survival Function by Gender (Z2)",
x = "Time (Days) to straphylocous aureaus infection")
# Log-log plot for Z3 (race)
burn.fit3 <- survfit(burn.surv ~ Z2, data = burn)
ggsurvplot(burn.fit3,
#legend.labs = c("Routine Bathing", "Body Cleansing"),
fun = "cloglog") +
labs(title = "Log(-log) of Survival Function by Race (Z3)",
x = "Time (Days) to straphylocous aureaus infection")
# Log-log plot for Z11 (burn type)
burn.fit4 <- survfit(burn.surv ~ as.factor(Z11), data = burn)
ggsurvplot(burn.fit4,
#legend.labs = c("Routine Bathing", "Body Cleansing"),
fun = "cloglog") +
labs(title = "Log(-log) of Survival Function for Burn Type (Z11)",
x = "Time (Days) to straphylocous aureaus infection")
# Cox ZPH test for correlation in the residuals
zph_test <- cox.zph(cox_step)
print(zph_test)
plot(zph_test)
# Log-log plot for Z1 (Treatment Type)
burn.fit1 <- survfit(burn.surv ~ Z1, data = burn)
ggsurvplot(burn.fit1,
legend.labs = c("Routine Bathing", "Body Cleansing"),
fun = "cloglog") +
labs(title = "Log(-log) of Survival Function by Treatment (Z1)",
x = "Time (Days) to straphylocous aureaus infection")
# Log-log plot for Z2 (gender)
burn.fit2 <- survfit(burn.surv ~ Z2, data = burn)
ggsurvplot(burn.fit2,
#legend.labs = c("Routine Bathing", "Body Cleansing"),
fun = "cloglog") +
labs(title = "Log(-log) of Survival Function by Gender (Z2)",
x = "Time (Days) to straphylocous aureaus infection")
# Log-log plot for Z3 (race)
burn.fit3 <- survfit(burn.surv ~ Z3, data = burn)
ggsurvplot(burn.fit3,
#legend.labs = c("Routine Bathing", "Body Cleansing"),
fun = "cloglog") +
labs(title = "Log(-log) of Survival Function by Race (Z3)",
x = "Time (Days) to straphylocous aureaus infection")
# Log-log plot for Z11 (burn type)
burn.fit4 <- survfit(burn.surv ~ as.factor(Z11), data = burn)
ggsurvplot(burn.fit4,
#legend.labs = c("Routine Bathing", "Body Cleansing"),
fun = "cloglog") +
labs(title = "Log(-log) of Survival Function for Burn Type (Z11)",
x = "Time (Days) to straphylocous aureaus infection")
# Cox ZPH test for correlation in the residuals
zph_test <- cox.zph(cox_step)
print(zph_test)
plot(zph_test)
# Log-log plot for Z1 (Treatment Type)
burn.fit1 <- survfit(burn.surv ~ Z1, data = burn)
ggsurvplot(burn.fit1,
legend.labs = c("Routine Bathing", "Body Cleansing"),
fun = "cloglog") +
labs(title = "Log(-log) of Survival Function by Treatment (Z1)",
x = "Time (Days) to straphylocous aureaus infection")
# Log-log plot for Z2 (gender)
burn.fit2 <- survfit(burn.surv ~ Z2, data = burn)
ggsurvplot(burn.fit2,
legend.labs = c("Male", "Female"),
fun = "cloglog") +
labs(title = "Log(-log) of Survival Function by Gender (Z2)",
x = "Time (Days) to straphylocous aureaus infection")
# Log-log plot for Z3 (race)
burn.fit3 <- survfit(burn.surv ~ Z3, data = burn)
ggsurvplot(burn.fit3,
#legend.labs = c("Routine Bathing", "Body Cleansing"),
fun = "cloglog") +
labs(title = "Log(-log) of Survival Function by Race (Z3)",
x = "Time (Days) to straphylocous aureaus infection")
# Log-log plot for Z11 (burn type)
burn.fit4 <- survfit(burn.surv ~ as.factor(Z11), data = burn)
ggsurvplot(burn.fit4,
#legend.labs = c("Routine Bathing", "Body Cleansing"),
fun = "cloglog") +
labs(title = "Log(-log) of Survival Function for Burn Type (Z11)",
x = "Time (Days) to straphylocous aureaus infection")
# Cox ZPH test for correlation in the residuals
zph_test <- cox.zph(cox_step)
print(zph_test)
plot(zph_test)
# Log-log plot for Z1 (Treatment Type)
burn.fit1 <- survfit(burn.surv ~ Z1, data = burn)
ggsurvplot(burn.fit1,
legend.labs = c("Routine Bathing", "Body Cleansing"),
fun = "cloglog") +
labs(title = "Log(-log) of Survival Function by Treatment (Z1)",
x = "Time (Days) to straphylocous aureaus infection")
# Log-log plot for Z2 (gender)
burn.fit2 <- survfit(burn.surv ~ Z2, data = burn)
ggsurvplot(burn.fit2,
legend.labs = c("Male", "Female"),
fun = "cloglog") +
labs(title = "Log(-log) of Survival Function by Gender (Z2)",
x = "Time (Days) to straphylocous aureaus infection")
# Log-log plot for Z3 (race)
burn.fit3 <- survfit(burn.surv ~ Z3, data = burn)
ggsurvplot(burn.fit3,
legend.labs = c("Nonwhite", "White"),
fun = "cloglog") +
labs(title = "Log(-log) of Survival Function by Race (Z3)",
x = "Time (Days) to straphylocous aureaus infection")
# Log-log plot for Z11 (burn type)
burn.fit4 <- survfit(burn.surv ~ as.factor(Z11), data = burn)
ggsurvplot(burn.fit4,
legend.labs = c("Chemical", "Scald", "Electric", "Flame"),
fun = "cloglog") +
labs(title = "Log(-log) of Survival Function for Burn Type (Z11)",
x = "Time (Days) to straphylocous aureaus infection")
# Cox ZPH test for correlation in the residuals
zph_test <- cox.zph(cox_step)
print(zph_test)
plot(zph_test)
levels(burn$Z11)
levels(as.factor(burn$Z11))
# Log-log plot for Z1 (Treatment Type)
burn.fit1 <- survfit(burn.surv ~ Z1, data = burn)
ggsurvplot(burn.fit1,
legend.labs = c("Routine Bathing", "Body Cleansing"),
fun = "cloglog") +
labs(title = "Log(-log) of Survival Function by Treatment (Z1)",
x = "Time (Days) to straphylocous aureaus infection")
# Log-log plot for Z2 (gender)
burn.fit2 <- survfit(burn.surv ~ Z2, data = burn)
ggsurvplot(burn.fit2,
legend.labs = c("Male", "Female"),
fun = "cloglog") +
labs(title = "Log(-log) of Survival Function by Gender (Z2)",
x = "Time (Days) to straphylocous aureaus infection")
# Log-log plot for Z3 (race)
burn.fit3 <- survfit(burn.surv ~ Z3, data = burn)
ggsurvplot(burn.fit3,
legend.labs = c("Nonwhite", "White"),
fun = "cloglog") +
labs(title = "Log(-log) of Survival Function by Race (Z3)",
x = "Time (Days) to straphylocous aureaus infection")
# Log-log plot for Z11 (burn type)
burn.fit4 <- survfit(burn.surv ~ as.factor(Z11), data = burn)
ggsurvplot(burn.fit4,
legend.labs = c("Chemical", "Scald", "Electric", "Flame"),
fun = "cloglog") +
labs(title = "Log(-log) of Survival Function for Burn Type (Z11)",
x = "Time (Days) to straphylocous aureaus infection")
# Cox ZPH test for correlation in the residuals
zph_test <- cox.zph(cox_step)
print(zph_test)
plot(zph_test)
# Log-log plot for Z1 (Treatment Type)
burn.fit1 <- survfit(burn.surv ~ Z1, data = burn)
ggsurvplot(burn.fit1,
legend.labs = c("Routine Bathing", "Body Cleansing"),
fun = "cloglog") +
labs(title = "Log(-log) of Survival Curve by Treatment (Z1)",
x = "Time (Days) to straphylocous aureaus infection")
# Log-log plot for Z2 (gender)
burn.fit2 <- survfit(burn.surv ~ Z2, data = burn)
ggsurvplot(burn.fit2,
legend.labs = c("Male", "Female"),
fun = "cloglog") +
labs(title = "Log(-log) of Survival Curve by Gender (Z2)",
x = "Time (Days) to straphylocous aureaus infection")
# Log-log plot for Z3 (race)
burn.fit3 <- survfit(burn.surv ~ Z3, data = burn)
ggsurvplot(burn.fit3,
legend.labs = c("Nonwhite", "White"),
fun = "cloglog") +
labs(title = "Log(-log) Survival Curve by Race (Z3)",
x = "Time (Days) to straphylocous aureaus infection")
# Log-log plot for Z11 (burn type)
burn.fit4 <- survfit(burn.surv ~ as.factor(Z11), data = burn)
ggsurvplot(burn.fit4,
legend.labs = c("Chemical", "Scald", "Electric", "Flame"),
fun = "cloglog") +
labs(title = "Log(-log) of Survival Curve by Burn Type (Z11)",
x = "Time (Days) to straphylocous aureaus infection")
# Cox ZPH test for correlation in the residuals
zph_test <- cox.zph(cox_step)
print(zph_test)
plot(zph_test)
# Log-log plot for Z1 (Treatment Type)
burn.fit1 <- survfit(burn.surv ~ Z1, data = burn)
ggsurvplot(burn.fit1,
legend.labs = c("Routine Bathing", "Body Cleansing"),
fun = "cloglog") +
labs(title = "Log(-log) of Survival Curve by Treatment (Z1)",
x = "Time (Days) to straphylocous aureaus infection")
# Log-log plot for Z2 (gender)
burn.fit2 <- survfit(burn.surv ~ Z2, data = burn)
ggsurvplot(burn.fit2,
legend.labs = c("Male", "Female"),
fun = "cloglog") +
labs(title = "Log(-log) of Survival Curve by Gender (Z2)",
x = "Time (Days) to straphylocous aureaus infection")
# Log-log plot for Z3 (race)
burn.fit3 <- survfit(burn.surv ~ Z3, data = burn)
ggsurvplot(burn.fit3,
legend.labs = c("Nonwhite", "White"),
fun = "cloglog") +
labs(title = "Log(-log) Survival Curve by Race (Z3)",
x = "Time (Days) to straphylocous aureaus infection")
# Log-log plot for Z11 (burn type)
burn.fit4 <- survfit(burn.surv ~ as.factor(Z11), data = burn)
ggsurvplot(burn.fit4,
legend.labs = c("Chemical", "Scald", "Electric", "Flame"),
fun = "cloglog") +
labs(title = "Log(-log) of Survival Curve by Burn Type (Z11)",
x = "Time (Days) to straphylocous aureaus infection")
# Cox ZPH test for correlation in the residuals
zph_test <- cox.zph(cox_step)
print(zph_test)
plot(zph_test)
